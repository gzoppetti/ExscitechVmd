<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>ReadPARM.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.2.14 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>ReadPARM.h</h1><a href="ReadPARM_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/***************************************************************************</font>
00002 <font class="comment"> * RCS INFORMATION:</font>
00003 <font class="comment"> *</font>
00004 <font class="comment"> *      $RCSfile: ReadPARM.h,v $</font>
00005 <font class="comment"> *      $Author: justin $        $Locker:  $                $State: Exp $</font>
00006 <font class="comment"> *      $Revision: 1.12 $      $Date: 2003/01/30 00:01:53 $</font>
00007 <font class="comment"> *</font>
00008 <font class="comment"> ***************************************************************************</font>
00009 <font class="comment"> * DESCRIPTION:</font>
00010 <font class="comment"> * NOTE:: Significant were made to the VMD version of</font>
00011 <font class="comment"> *        Bill Ross's original code in order to make it easy to hook</font>
00012 <font class="comment"> *        into VMD plugin structures.</font>
00013 <font class="comment"> * Here is what was changed:</font>
00014 <font class="comment"> *     Functions became Class Methods, data became instance variables</font>
00015 <font class="comment"> *     The Code to check for compressed files before opening was disabled</font>
00016 <font class="comment"> *     Methods get_parm_atom, get_parm_bond, get_hydrogen_bond,</font>
00017 <font class="comment"> *     get_parm_natoms, get_parm_nbonds, get_parm_boxInfo were added in </font>
00018 <font class="comment"> *     order to convert from prm.c parlance to VMD conventions.</font>
00019 <font class="comment"> *     RCS Information headers and footers were added.</font>
00020 <font class="comment"> ***************************************************************************/</font>
00021 
00022 <font class="comment">/*</font>
00023 <font class="comment"> * COPYRIGHT 1992, REGENTS OF THE UNIVERSITY OF CALIFORNIA</font>
00024 <font class="comment"> *</font>
00025 <font class="comment"> *  prm.c - read information from an amber PARM topology file:</font>
00026 <font class="comment"> *      atom/residue/bond/charge info, plus force field data.</font>
00027 <font class="comment"> *      This file and the accompanying prm.h may be distributed</font>
00028 <font class="comment"> *      provided this notice is retained unmodified and provided</font>
00029 <font class="comment"> *      that any modifications to the rest of the file are noted</font>
00030 <font class="comment"> *      in comments.</font>
00031 <font class="comment"> *</font>
00032 <font class="comment"> *      Bill Ross, UCSF 1994</font>
00033 <font class="comment"> */</font>
00034 
00035 <font class="preprocessor">#ifndef READPARM_H</font>
00036 <font class="preprocessor"></font><font class="preprocessor">#define READPARM_H</font>
00037 <font class="preprocessor"></font>
00038 <font class="comment">// XXX enable the new AMBER reading code, deals with packed </font>
00039 <font class="comment">// fortran 12I6 integer formats.</font>
<a name="l00040"></a><a class="code" href="ReadPARM_8h.html#a0">00040</a> <font class="preprocessor">#define USENEWCODE 1</font>
00041 <font class="preprocessor"></font>
00042 <font class="preprocessor">#include &lt;stdio.h&gt;</font>
00043 <font class="preprocessor">#include &lt;stdlib.h&gt;</font>
00044 <font class="preprocessor">#include &lt;ctype.h&gt;</font>
00045 <font class="preprocessor">#include &lt;sys/types.h&gt;</font>
00046 <font class="preprocessor">#include &lt;sys/stat.h&gt;</font>
00047 <font class="preprocessor">#include &lt;errno.h&gt;</font>
00048 <font class="preprocessor">#include &lt;string.h&gt;</font>
00049 <font class="preprocessor">#include "<a class="code" href="molfile__plugin_8h.html">molfile_plugin.h</a>"</font>  <font class="comment">// needed for molfile return codes etc</font>
00050 
00051 <font class="preprocessor">#if 0 </font>
00052 <font class="preprocessor"></font><font class="preprocessor">#define _REAL           double</font>
00053 <font class="preprocessor"></font><font class="preprocessor">#define DBLFMT          "%lf"</font>
00054 <font class="preprocessor"></font><font class="preprocessor">#else</font>
<a name="l00055"></a><a class="code" href="ReadPARM_8h.html#a1">00055</a> <font class="preprocessor"></font><font class="preprocessor">#define _REAL           float</font>
<a name="l00056"></a><a class="code" href="ReadPARM_8h.html#a2">00056</a> <font class="preprocessor"></font><font class="preprocessor">#define DBLFMT          "%f"</font>
00057 <font class="preprocessor"></font><font class="preprocessor">#endif</font>
00058 <font class="preprocessor"></font>
<a name="l00059"></a><a class="code" href="structparm.html">00059</a> <font class="keyword">typedef</font> <font class="keyword">struct </font><a class="code" href="structparm.html">parm</a> {
<a name="l00060"></a><a class="code" href="structparm.html#m0">00060</a>         <font class="keywordtype">char</font>    <a class="code" href="structparm.html#m0">ititl</a>[81];
00061         <font class="keywordtype">int</font>     <a class="code" href="structparm.html#m1">IfBox</a>, <a class="code" href="structparm.html#m2">Nmxrs</a>, <a class="code" href="structparm.html#m3">IfCap</a>,
00062                  <a class="code" href="structparm.html#m4">Natom</a>,  <a class="code" href="structparm.html#m5">Ntypes</a>,  <a class="code" href="structparm.html#m6">Nbonh</a>,  <a class="code" href="structparm.html#m7">Mbona</a>,  <a class="code" href="structparm.html#m8">Ntheth</a>,  <a class="code" href="structparm.html#m9">Mtheta</a>, 
00063                  <a class="code" href="structparm.html#m10">Nphih</a>,  <a class="code" href="structparm.html#m11">Mphia</a>,  <a class="code" href="structparm.html#m12">Nhparm</a>, <a class="code" href="structparm.html#m13">Nparm</a>, <a class="code" href="structparm.html#m14">Nnb</a>, <a class="code" href="structparm.html#m15">Nres</a>,
00064                  <a class="code" href="structparm.html#m16">Nbona</a>,  <a class="code" href="structparm.html#m17">Ntheta</a>,  <a class="code" href="structparm.html#m18">Nphia</a>,  <a class="code" href="structparm.html#m19">Numbnd</a>,  <a class="code" href="structparm.html#m20">Numang</a>,  <a class="code" href="structparm.html#m21">Nptra</a>,
00065                  <a class="code" href="structparm.html#m22">Natyp</a>,  <a class="code" href="structparm.html#m23">Nphb</a>, <a class="code" href="structparm.html#m24">Nat3</a>, <a class="code" href="structparm.html#m25">Ntype2d</a>, <a class="code" href="structparm.html#m26">Nttyp</a>, <a class="code" href="structparm.html#m27">Nspm</a>, <a class="code" href="structparm.html#m28">Iptres</a>, <a class="code" href="structparm.html#m29">Nspsol</a>,
00066                  <a class="code" href="structparm.html#m30">Ipatm</a>, <a class="code" href="structparm.html#m31">Natcap</a>;
<a name="l00067"></a><a class="code" href="structparm.html#m33">00067</a>         <font class="keywordtype">char</font>    *<a class="code" href="structparm.html#m32">AtomNames</a>, *<a class="code" href="structparm.html#m33">ResNames</a>, *<a class="code" href="structparm.html#m34">AtomSym</a>, *<a class="code" href="structparm.html#m35">AtomTree</a>;
<a name="l00068"></a><a class="code" href="structparm.html#m40">00068</a>         <a class="code" href="ReadPARM_8h.html#a1">_REAL</a>   *<a class="code" href="structparm.html#m36">Charges</a>, *<a class="code" href="structparm.html#m37">Masses</a>, *<a class="code" href="structparm.html#m38">Rk</a>, *<a class="code" href="structparm.html#m39">Req</a>, *<a class="code" href="structparm.html#m40">Tk</a>, *<a class="code" href="structparm.html#m41">Teq</a>, *<a class="code" href="structparm.html#m42">Pk</a>, *<a class="code" href="structparm.html#m43">Pn</a>, *<a class="code" href="structparm.html#m44">Phase</a>,
00069                  *<a class="code" href="structparm.html#m45">Solty</a>, *<a class="code" href="structparm.html#m46">Cn1</a>, *<a class="code" href="structparm.html#m47">Cn2</a>, *<a class="code" href="structparm.html#m48">HB12</a>, *<a class="code" href="structparm.html#m49">HB6</a>;
00070         <a class="code" href="ReadPARM_8h.html#a1">_REAL</a>   <a class="code" href="structparm.html#m50">Box</a>[3], <a class="code" href="structparm.html#m51">Cutcap</a>, <a class="code" href="structparm.html#m52">Xcap</a>, <a class="code" href="structparm.html#m53">Ycap</a>, <a class="code" href="structparm.html#m54">Zcap</a>;
<a name="l00071"></a><a class="code" href="structparm.html#m60">00071</a>         <font class="keywordtype">int</font>     *<a class="code" href="structparm.html#m55">Iac</a>, *<a class="code" href="structparm.html#m56">Iblo</a>, *<a class="code" href="structparm.html#m57">Cno</a>, *<a class="code" href="structparm.html#m58">Ipres</a>, *<a class="code" href="structparm.html#m59">ExclAt</a>, *<a class="code" href="structparm.html#m60">TreeJoin</a>, 
00072                 *<a class="code" href="structparm.html#m61">AtomRes</a>, *<a class="code" href="structparm.html#m62">BondHAt1</a>, *<a class="code" href="structparm.html#m63">BondHAt2</a>, *<a class="code" href="structparm.html#m64">BondHNum</a>, *<a class="code" href="structparm.html#m65">BondAt1</a>, *<a class="code" href="structparm.html#m66">BondAt2</a>, 
00073                 *<a class="code" href="structparm.html#m67">BondNum</a>, *<a class="code" href="structparm.html#m68">AngleHAt1</a>, *<a class="code" href="structparm.html#m69">AngleHAt2</a>, *<a class="code" href="structparm.html#m70">AngleHAt3</a>, *<a class="code" href="structparm.html#m71">AngleHNum</a>, 
00074                 *<a class="code" href="structparm.html#m72">AngleAt1</a>, *<a class="code" href="structparm.html#m73">AngleAt2</a>, *<a class="code" href="structparm.html#m74">AngleAt3</a>, *<a class="code" href="structparm.html#m75">AngleNum</a>, *<a class="code" href="structparm.html#m76">DihHAt1</a>, 
00075                 *<a class="code" href="structparm.html#m77">DihHAt2</a>, *<a class="code" href="structparm.html#m78">DihHAt3</a>, *<a class="code" href="structparm.html#m79">DihHAt4</a>, *<a class="code" href="structparm.html#m80">DihHNum</a>, *<a class="code" href="structparm.html#m81">DihAt1</a>, *<a class="code" href="structparm.html#m82">DihAt2</a>, 
00076                 *<a class="code" href="structparm.html#m83">DihAt3</a>, *<a class="code" href="structparm.html#m84">DihAt4</a>, *<a class="code" href="structparm.html#m85">DihNum</a>, *<a class="code" href="structparm.html#m86">Boundary</a>;
00077 } <a class="code" href="structparm.html">parmstruct</a>;
00078 
00079 <font class="comment">// put the class in an anonymous namespace to give it internal linkage</font>
00080 <font class="keyword">namespace </font>{
<a name="l00081"></a><a class="code" href="classReadPARM.html">00081</a>   <font class="keyword">class </font><a class="code" href="classReadPARM.html">ReadPARM</a> {
00082   <font class="keyword">public</font>:
<a name="l00083"></a><a class="code" href="classReadPARM.html#a0">00083</a>     <a class="code" href="classReadPARM.html#a0">ReadPARM</a>() {<a class="code" href="classReadPARM.html#m0">popn</a> = 0;}
<a name="l00084"></a><a class="code" href="classReadPARM.html#a1">00084</a>     <a class="code" href="classReadPARM.html#a1">~ReadPARM</a>(<font class="keywordtype">void</font>) {}
00085  
<a name="l00086"></a><a class="code" href="classReadPARM.html#m0">00086</a>     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#m0">popn</a>;
<a name="l00087"></a><a class="code" href="classReadPARM.html#m1">00087</a>     <a class="code" href="structparm.html">parmstruct</a> *<a class="code" href="classReadPARM.html#m1">prm</a>;
00088     FILE *<a class="code" href="classReadPARM.html#a2">open_parm_file</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *<a class="code" href="xsfplugin_8C.html#a2">name</a>);
00089     <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a3">close_parm_file</a>(FILE *fileptr);
00090     <font class="keywordtype">char</font> *<a class="code" href="classReadPARM.html#a4">get</a>(<font class="keywordtype">int</font> size);
00091     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a5">preadln</a>(FILE *file, <font class="keywordtype">char</font> *string);
00092     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a6">readparm</a>(FILE *file);
00093     <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a7">get_parm_atom</a>(<font class="keywordtype">int</font>, <font class="keywordtype">char</font> *, <font class="keywordtype">char</font> *, <font class="keywordtype">char</font> *, <font class="keywordtype">char</font> *, <font class="keywordtype">int</font> *, <font class="keywordtype">float</font> *,
00094                        <font class="keywordtype">float</font> *);
00095 
00096     <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a8">get_parm_bond</a>(<font class="keywordtype">int</font>, <font class="keywordtype">int</font> fromAtom[], <font class="keywordtype">int</font> toAtom[]);
00097     <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a9">get_hydrogen_bond</a>(<font class="keywordtype">int</font>, <font class="keywordtype">int</font> fromAtom[], <font class="keywordtype">int</font> toAtom[]);
00098     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a10">get_parm_natoms</a>();
00099     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a11">get_parm_nbonds</a>();
00100     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a12">get_parm_boxInfo</a>();
00101     <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(FILE *fp, <font class="keywordtype">int</font> *data, <font class="keywordtype">int</font> count);  
00102   };
00103 }
00104 
00105 
00106 <font class="comment">/*      fortran formats </font>
00107 <font class="comment"> *       9118 FORMAT(12I6)</font>
00108 <font class="comment"> *       9128 FORMAT(5E16.8)</font>
00109 <font class="comment">static char     *f9118 = (char *) "%6d%6d%6d%6d%6d%6d%6d%6d%6d%6d%6d%6d\n";</font>
00110 <font class="comment"> */</font>
00111 
<a name="l00112"></a><a class="code" href="ReadPARM_8h.html#a4">00112</a> <font class="keyword">static</font> <font class="keywordtype">int</font> <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(FILE *f) {
00113   <font class="keywordtype">int</font> c;
00114 
00115   <font class="comment">/* skip to eoln */</font>
00116   <font class="keywordflow">while</font>((c = getc(f)) != <font class="charliteral">'\n'</font>) {
00117     <font class="keywordflow">if</font> (c == EOF) 
00118       <font class="keywordflow">return</font> -1;
00119   }
00120 
00121   <font class="keywordflow">return</font> 0;
00122 }  
00123 
00124 <font class="comment">/***********************************************************************</font>
00125 <font class="comment">                                open_parm_file()</font>
00126 <font class="comment">************************************************************************/</font>
00127 
00128 <font class="comment">/*</font>
00129 <font class="comment"> *  open_parm_file() - fopen regular or popen compressed file for reading</font>
00130 <font class="comment"> */</font>
00131 
<a name="l00132"></a><a class="code" href="classReadPARM.html#a2">00132</a> FILE *<a class="code" href="classReadPARM.html#a2">ReadPARM::open_parm_file</a>(<font class="keyword">const</font> <font class="keywordtype">char</font> *<a class="code" href="xsfplugin_8C.html#a2">name</a>) {
00133         <font class="keyword">struct </font>stat     buf;
00134         <font class="keywordtype">char</font>            cbuf[120];
00135         <font class="keywordtype">int</font>             length, compressed;
00136         FILE            *fp;
00137 
00138         length = strlen(<a class="code" href="xsfplugin_8C.html#a2">name</a>);
00139         compressed = 0;  <font class="comment">// Just to start</font>
00140 <font class="comment">//      compressed = iscompressed(name);</font>
00141         strcpy(cbuf, <a class="code" href="xsfplugin_8C.html#a2">name</a>);
00142 
00143         <font class="comment">/*</font>
00144 <font class="comment">         *  if file doesn't exist, maybe it has been compressed/decompressed</font>
00145 <font class="comment">         */</font>
00146 
00147         <font class="keywordflow">if</font> (stat(cbuf, &amp;buf) == -1) {
00148                 <font class="keywordflow">switch</font> (errno) {
00149                 <font class="keywordflow">case</font> ENOENT:    {
00150                         <font class="keywordflow">if</font> (!compressed) {
00151                                 strcat(cbuf, <font class="stringliteral">".Z"</font>);
00152                                 <font class="keywordflow">if</font> (stat(cbuf, &amp;buf) == -1) {
00153                                         printf(<font class="stringliteral">"%s, %s: does not exist\n"</font>, 
00154                                                 <a class="code" href="xsfplugin_8C.html#a2">name</a>, cbuf);
00155                                         <font class="keywordflow">return</font>(NULL);
00156                                 }
00157                                 compressed++;
00158                                 <font class="comment">// Don't modify the filename</font>
00159                                 <font class="comment">//strcat(name, ".Z"); /* TODO: add protection */</font>
00160                         } <font class="keywordflow">else</font> {
00161                                 cbuf[length-2] = <font class="charliteral">'\0'</font>;
00162                                 <font class="keywordflow">if</font> (stat(cbuf, &amp;buf) == -1) {
00163                                         printf(<font class="stringliteral">"%s, %s: does not exist\n"</font>, 
00164                                                         <a class="code" href="xsfplugin_8C.html#a2">name</a>, cbuf);
00165                                         <font class="keywordflow">return</font>(NULL);
00166                                 }
00167                                 compressed = 0;
00168                         }
00169                         <font class="keywordflow">break</font>;
00170                 }
00171                 <font class="keywordflow">default</font>:
00172                         <font class="keywordflow">return</font>(NULL);
00173                 }
00174         }
00175 
00176         <font class="comment">/*</font>
00177 <font class="comment">         *  open the file</font>
00178 <font class="comment">         */</font>
00179 <font class="preprocessor">#if defined(_MSC_VER)</font>
00180 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (compressed) {
00181           <font class="comment">/* NO "zcat" on Win32 */</font>
00182           printf(<font class="stringliteral">"Cannot load compressed PARM files on Windows.\n"</font>);
00183           <font class="keywordflow">return</font> NULL;
00184         }
00185 <font class="preprocessor">#else</font>
00186 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (compressed) {
00187                 <font class="keywordtype">char</font> pcmd[120];
00188                 <a class="code" href="classReadPARM.html#m0">popn</a> = 1;
00189 
00190                 sprintf(pcmd, <font class="stringliteral">"zcat %s"</font>, cbuf);
00191                 <font class="keywordflow">if</font> ((fp = popen(pcmd, <font class="stringliteral">"r"</font>)) == NULL) {
00192                         perror(pcmd);
00193                         <font class="keywordflow">return</font> NULL;
00194                 }
00195         }
00196 <font class="preprocessor">#endif</font>
00197 <font class="preprocessor"></font>        <font class="keywordflow">else</font> {
00198                 <font class="keywordflow">if</font> ((fp = fopen(cbuf, <font class="stringliteral">"r"</font>)) == NULL) {
00199                         perror(cbuf);
00200                         <font class="keywordflow">return</font> NULL;
00201                 }
00202         }
00203         <font class="keywordflow">return</font>(fp);
00204 }
00205 
00206 <font class="comment">/***********************************************************************</font>
00207 <font class="comment">                            close_parm_file   </font>
00208 <font class="comment">************************************************************************/</font>
00209 
00210 <font class="comment">/*</font>
00211 <font class="comment"> *  close_parm_file() - close fopened or popened file</font>
00212 <font class="comment"> */</font>
<a name="l00213"></a><a class="code" href="classReadPARM.html#a3">00213</a> <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a3">ReadPARM::close_parm_file</a>(FILE *fileptr) {
00214 <font class="preprocessor">#if defined(_MSC_VER)</font>
00215 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (popn) {
00216     printf(<font class="stringliteral">"pclose() no such function on win32!\n"</font>);
00217   } <font class="keywordflow">else</font> {
00218     <font class="keywordflow">if</font> (fclose(fileptr) == -1)
00219       perror(<font class="stringliteral">"fclose"</font>);
00220   }
00221 <font class="preprocessor">#else</font>
00222 <font class="preprocessor"></font>  <font class="keywordflow">if</font> (popn) {
00223     <font class="keywordflow">if</font> (pclose(fileptr) == -1)
00224       perror(<font class="stringliteral">"pclose"</font>);
00225   } <font class="keywordflow">else</font> {
00226     <font class="keywordflow">if</font> (fclose(fileptr) == -1)
00227       perror(<font class="stringliteral">"fclose"</font>);
00228   }
00229 <font class="preprocessor">#endif</font>
00230 <font class="preprocessor"></font>}
00231 
00232 
00233 <font class="comment">/***********************************************************************</font>
00234 <font class="comment">                                      GET()</font>
00235 <font class="comment">************************************************************************/</font>
<a name="l00236"></a><a class="code" href="classReadPARM.html#a4">00236</a> <font class="keywordtype">char</font> *<a class="code" href="classReadPARM.html#a4">ReadPARM::get</a>(<font class="keywordtype">int</font> size) {
00237         <font class="keywordtype">char</font>    *ptr;
00238 
00239 <font class="preprocessor">#ifdef DEBUG</font>
00240 <font class="preprocessor"></font>        printf(<font class="stringliteral">"malloc %d\n"</font>, size);
00241         fflush(stdout);
00242 <font class="preprocessor">#endif</font>
00243 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (size ==0)
00244                 <font class="keywordflow">return</font>((<font class="keywordtype">char</font> *) NULL);
00245 
00246         <font class="keywordflow">if</font> ((ptr = (<font class="keywordtype">char</font> *) malloc((<font class="keywordtype">unsigned</font>)size)) == NULL) {
00247                 printf(<font class="stringliteral">"malloc %d"</font>, size);
00248                 fflush(stdout);
00249                 perror(<font class="stringliteral">"malloc err:"</font>);
00250         fprintf(stderr, <font class="stringliteral">"Exiting due to ReadPARM memory allocation error.\n"</font>);
00251         }
00252         <font class="keywordflow">return</font>(ptr);
00253 }
00254 
00255 <font class="comment">/***********************************************************************</font>
00256 <font class="comment">                                PREADLN()</font>
00257 <font class="comment">************************************************************************/</font>
<a name="l00258"></a><a class="code" href="classReadPARM.html#a5">00258</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a5">ReadPARM::preadln</a>(FILE *file, <font class="keywordtype">char</font> *string) {
00259   <font class="keywordtype">int</font> i, j;
00260 
00261   <font class="keywordflow">for</font> (i=0; i&lt;81; i++) {
00262     <font class="keywordflow">if</font> ((j = getc(file)) == EOF) {
00263       printf(<font class="stringliteral">"Error: unexpected EOF in Parm file\n"</font>);
00264       <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00265     }
00266 
00267     string[i] = (char) j;
00268     <font class="keywordflow">if</font> (string[i] == <font class="charliteral">'\n'</font>) {
00269       <font class="keywordflow">break</font>;
00270     }
00271   }
00272 
00273   <font class="keywordflow">if</font> (i == 80  &amp;&amp;  string[i] != <font class="charliteral">'\n'</font>) {
00274     printf(<font class="stringliteral">"Error: line too long in Parm file:\n%.80s"</font>, string);
00275     <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00276   }
00277 
00278   <font class="keywordflow">return</font> 0; <font class="comment">/* success */</font>
00279 }
00280 
00281 <font class="comment">/***************************************************************************</font>
00282 <font class="comment">                                READPARM()</font>
00283 <font class="comment">****************************************************************************/</font>
00284 <font class="comment">/*</font>
00285 <font class="comment"> * readparm() - instantiate a given parmstruct</font>
00286 <font class="comment"> */</font>
<a name="l00287"></a><a class="code" href="classReadPARM.html#a6">00287</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a6">ReadPARM::readparm</a>(FILE *file) {
00288         <font class="comment">//</font>
00289         <font class="comment">// XXX This code leaks memory every time it's run!  prm is allocated</font>
00290         <font class="comment">// but its data is never freed, even when ReadPARM itself is deleted.</font>
00291         <font class="comment">// I've added exception code so we at least have a chance of </font>
00292         <font class="comment">// recovering gracefully from a memory allocation error.</font>
00293 
00294         <a class="code" href="ReadPARM_8h.html#a1">_REAL</a>           *H;
00295         <font class="keywordtype">int</font>             i, res, ifpert;
00296         <font class="keywordtype">int</font> *buffer; <font class="comment">// used for reading fortran integer blocks</font>
00297 
00298         <a class="code" href="classReadPARM.html#m1">prm</a> = (<a class="code" href="structparm.html">parmstruct</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="structparm.html">parmstruct</a>));
00299         <font class="keywordflow">if</font> (<a class="code" href="classReadPARM.html#m1">prm</a> == NULL) {
00300           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>; <font class="comment">/* allocation failure */</font>
00301         }
00302 
00303         <font class="comment">/* READ TITLE */</font>
00304         <font class="keywordflow">if</font> (<a class="code" href="classReadPARM.html#a5">preadln</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m0">ititl</a>) != 0) {
00305           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00306         }
00307 
00308         <font class="comment">/* READ CONTROL INTEGERS */</font>
00309 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00310 <font class="preprocessor"></font>        fscanf(file, f9118, 
00311                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>,  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m7">Mbona</a>, 
00312                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m9">Mtheta</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m11">Mphia</a>, 
00313                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m12">Nhparm</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m13">Nparm</a>,  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m14">Nnb</a>,   &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>);
00314 
00315         fscanf(file, f9118, 
00316                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>,  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a>, 
00317                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>,  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m22">Natyp</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>, 
00318                 &amp;ifpert,      &amp;idum,        &amp;idum,       &amp;idum);
00319 
00320         fscanf(file, <font class="stringliteral">" %d %d %d %d %d %d"</font>, 
00321                 &amp;idum, &amp;idum,&amp;idum,&amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m1">IfBox</a>,&amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m2">Nmxrs</a>,&amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m3">IfCap</a>);
00322 <font class="preprocessor">#else</font>
00323 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[30];
00324         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file,buffer,30)) { 
00325           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00326         }
00327         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a> = buffer[0];
00328         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a> = buffer[1];
00329         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a> = buffer[2];
00330         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m7">Mbona</a> = buffer[3];
00331         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a> = buffer[4];
00332         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m9">Mtheta</a> = buffer[5];
00333         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a> = buffer[6];
00334         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m11">Mphia</a> = buffer[7];
00335         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m12">Nhparm</a> = buffer[8];
00336         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m13">Nparm</a> = buffer[9];
00337         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m14">Nnb</a> = buffer[10];
00338         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a> = buffer[11];
00339         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a> = buffer[12];
00340         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a> = buffer[13];
00341         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a> = buffer[14];
00342         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a> = buffer[15];
00343         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a> = buffer[16];
00344         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a> = buffer[17];
00345         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m22">Natyp</a> = buffer[18];
00346         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a> = buffer[19];
00347         ifpert = buffer[20];
00348         <font class="comment">// items 21 through 26 are ignored currently.</font>
00349         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m1">IfBox</a> = buffer[27];
00350         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m2">Nmxrs</a> = buffer[28];
00351         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m3">IfCap</a> = buffer[29];
00352         <font class="keyword">delete</font> [] buffer;
00353 <font class="preprocessor">#endif</font>
00354 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00355 
00356 
00357        <font class="keywordflow">if</font> (ifpert) {
00358          printf(<font class="stringliteral">"not equipped to read perturbation prmtop\n"</font>);
00359          free(<a class="code" href="classReadPARM.html#m1">prm</a>);
00360          <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00361        }
00362 
00363 
00364         <font class="comment">/* ALLOCATE MEMORY */</font>
00365         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m24">Nat3</a> = 3 * <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>;
00366         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m25">Ntype2d</a> = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a> * <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a>;
00367         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m26">Nttyp</a> = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a>*(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m5">Ntypes</a>+1)/2;
00368 
00369         <font class="comment">/*</font>
00370 <font class="comment">         * get most of the indirect stuff; some extra allowed for char arrays</font>
00371 <font class="comment">         */</font>
00372         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m32">AtomNames</a> = (<font class="keywordtype">char</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>+81);
00373         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m36">Charges</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00374         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m37">Masses</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00375         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m55">Iac</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00376         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m56">Iblo</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00377         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m57">Cno</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m25">Ntype2d</a>);
00378         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a> = (<font class="keywordtype">char</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(4* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>+81);
00379         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*( <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>+1));
00380         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m38">Rk</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a>);
00381         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m39">Req</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a>);
00382         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m40">Tk</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a>);
00383         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m41">Teq</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a>);
00384         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m42">Pk</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>);
00385         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m43">Pn</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>);
00386         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m44">Phase</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>);
00387         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m45">Solty</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m22">Natyp</a>);
00388         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m46">Cn1</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m26">Nttyp</a>);
00389         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m47">Cn2</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m26">Nttyp</a>);
00390         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m62">BondHAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>);
00391         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m63">BondHAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>);
00392         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m64">BondHNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>);
00393         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m65">BondAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>);
00394         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m66">BondAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>);
00395         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m67">BondNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>);
00396         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m68">AngleHAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>);
00397         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m69">AngleHAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>);
00398         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m70">AngleHAt3</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>);
00399         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m71">AngleHNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>);
00400         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m72">AngleAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)* <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>);
00401         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m73">AngleAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>);
00402         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m74">AngleAt3</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>);
00403         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m75">AngleNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>);
00404         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m76">DihHAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>);
00405         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m77">DihHAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>);
00406         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m78">DihHAt3</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>);
00407         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m79">DihHAt4</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>);
00408         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m80">DihHNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>);
00409         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m81">DihAt1</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>);
00410         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m82">DihAt2</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>);
00411         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m83">DihAt3</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>);
00412         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m84">DihAt4</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>);
00413         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m85">DihNum</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>);
00414         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m59">ExclAt</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m14">Nnb</a>);
00415         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m48">HB12</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>);
00416         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m49">HB6</a> = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>);
00417         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m34">AtomSym</a> = (<font class="keywordtype">char</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>+81);
00418         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m35">AtomTree</a> = (<font class="keywordtype">char</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>+81);
00419         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m60">TreeJoin</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00420         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m61">AtomRes</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>);
00421 
00422         <font class="comment">/* </font>
00423 <font class="comment">         * READ ATOM NAMES -IH(M04)</font>
00424 <font class="comment">         */</font>
00425         <font class="keywordflow">for</font> (i=0; i&lt;(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>/20 + (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>%20 ? 1 : 0)); i++) {
00426                 <a class="code" href="classReadPARM.html#a5">preadln</a>(file, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m32">AtomNames</a>[i*80]);
00427         }
00428 
00429         <font class="comment">/* </font>
00430 <font class="comment">         * READ ATOM CHARGES -X(L15)</font>
00431 <font class="comment">         *      (pre-multiplied by an energy factor of 18.2223 == sqrt(332)</font>
00432 <font class="comment">         *       for faster force field calculations)</font>
00433 <font class="comment">         */</font>
00434         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++)
00435           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m36">Charges</a>[i]);
00436         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00437 
00438         <font class="comment">/* </font>
00439 <font class="comment">         * READ ATOM MASSES -X(L20)</font>
00440 <font class="comment">         */</font>
00441         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++)
00442           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m37">Masses</a>[i]);
00443         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00444 
00445         <font class="comment">/* </font>
00446 <font class="comment">         * READ ATOM L-J TYPES -IX(I04)</font>
00447 <font class="comment">         */</font>
00448 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00449 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++) 
00450           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m55">Iac</a>[i]);
00451 <font class="preprocessor">#else</font>
00452 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m55">Iac</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>)) {
00453           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00454         }
00455 <font class="preprocessor">#endif</font>
00456 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00457 
00458         <font class="comment">/* </font>
00459 <font class="comment">         * READ ATOM INDEX TO 1st IN EXCLUDED ATOM LIST "NATEX" -IX(I08)</font>
00460 <font class="comment">         */</font>
00461 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00462 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++)
00463           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m56">Iblo</a>[i]);
00464 <font class="preprocessor">#else</font>
00465 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m56">Iblo</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>)) {
00466           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00467         }
00468 <font class="preprocessor">#endif</font>
00469 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00470 
00471         <font class="comment">/* </font>
00472 <font class="comment">         * READ TYPE INDEX TO N-B TYPE -IX(I06)</font>
00473 <font class="comment">         */</font>
00474 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00475 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m25">Ntype2d</a>; i++)
00476           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m57">Cno</a>[i]);
00477 <font class="preprocessor">#else</font>
00478 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m57">Cno</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m25">Ntype2d</a>)) {
00479           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00480         } 
00481 <font class="preprocessor">#endif</font>
00482 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00483 
00484         <font class="comment">/* </font>
00485 <font class="comment">         * READ RES NAMES (4 chars each, 4th blank) -IH(M02)</font>
00486 <font class="comment">         */</font>
00487         <font class="keywordflow">for</font> (i=0; i&lt;(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>/20 + (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>%20 ? 1 : 0)); i++)
00488           <a class="code" href="classReadPARM.html#a5">preadln</a>(file, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[i*80]);
00489 
00490         <font class="comment">/* </font>
00491 <font class="comment">         * READ RES POINTERS TO 1st ATOM                -IX(I02)</font>
00492 <font class="comment">         */</font>
00493 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00494 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>; i++) 
00495           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[i]);
00496 <font class="preprocessor">#else</font>
00497 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>)) {
00498           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00499         }
00500 <font class="preprocessor">#endif</font>
00501 <font class="preprocessor"></font>        <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a> + 1;
00502         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00503 
00504         <font class="comment">/* </font>
00505 <font class="comment">         * READ BOND FORCE CONSTANTS                    -RK()</font>
00506 <font class="comment">         */</font>
00507         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a>; i++) 
00508           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m38">Rk</a>[i]);
00509         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00510 
00511         <font class="comment">/* </font>
00512 <font class="comment">         * READ BOND LENGTH OF MINIMUM ENERGY           -REQ()</font>
00513 <font class="comment">         */</font>
00514         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m19">Numbnd</a>; i++) 
00515           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m39">Req</a>[i]);
00516         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00517 
00518         <font class="comment">/* </font>
00519 <font class="comment">         * READ BOND ANGLE FORCE CONSTANTS (following Rk nomen) -TK()</font>
00520 <font class="comment">         */</font>
00521         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a>; i++) 
00522           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m40">Tk</a>[i]);
00523         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00524 
00525         <font class="comment">/* </font>
00526 <font class="comment">         * READ BOND ANGLE OF MINIMUM ENERGY (following Req nomen) -TEQ()</font>
00527 <font class="comment">         */</font>
00528         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m20">Numang</a>; i++) 
00529           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m41">Teq</a>[i]);
00530         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00531 
00532         <font class="comment">/* </font>
00533 <font class="comment">         * READ DIHEDRAL PEAK MAGNITUDE                 -PK()</font>
00534 <font class="comment">         */</font>
00535         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>; i++) 
00536           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m42">Pk</a>[i]);
00537         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00538 
00539         <font class="comment">/* </font>
00540 <font class="comment">         * READ DIHEDRAL PERIODICITY                    -PN()</font>
00541 <font class="comment">         */</font>
00542         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>; i++) 
00543           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m43">Pn</a>[i]);
00544         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00545 
00546         <font class="comment">/* </font>
00547 <font class="comment">         * READ DIHEDRAL PHASE                          -PHASE()</font>
00548 <font class="comment">         */</font>
00549         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m21">Nptra</a>; i++) 
00550           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m44">Phase</a>[i]);
00551         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00552 
00553         <font class="comment">/* </font>
00554 <font class="comment">         * ?? "RESERVED"                                -SOLTY()</font>
00555 <font class="comment">         */</font>
00556         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m22">Natyp</a>; i++) 
00557           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m45">Solty</a>[i]);
00558         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00559 
00560         <font class="comment">/* </font>
00561 <font class="comment">         * READ L-J R**12 FOR ALL PAIRS OF ATOM TYPES   -CN1()</font>
00562 <font class="comment">         *      (SHOULD BE 0 WHERE H-BONDS)</font>
00563 <font class="comment">         */</font>
00564         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m26">Nttyp</a>; i++) 
00565           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m46">Cn1</a>[i]);
00566         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00567 
00568         <font class="comment">/* </font>
00569 <font class="comment">         * READ L-J R**6 FOR ALL PAIRS OF ATOM TYPES    -CN2()</font>
00570 <font class="comment">         *      (SHOULD BE 0 WHERE H-BONDS)</font>
00571 <font class="comment">         */</font>
00572         <font class="keywordflow">for</font> (i=0; i&lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m26">Nttyp</a>; i++) 
00573           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m47">Cn2</a>[i]);
00574         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00575 
00576         <font class="comment">/* </font>
00577 <font class="comment">         * READ COVALENT BOND W/ HYDROGEN (3*(atnum-1)): </font>
00578 <font class="comment">         *      IBH = ATOM1             -IX(I12)</font>
00579 <font class="comment">         *      JBH = ATOM2             -IX(I14)</font>
00580 <font class="comment">         *      ICBH = BOND ARRAY PTR   -IX(I16)</font>
00581 <font class="comment">         */</font>
00582 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00583 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>; i++) 
00584           fscanf(file, <font class="stringliteral">" %d %d %d"</font>, 
00585                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m62">BondHAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m63">BondHAt2</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m64">BondHNum</a>[i]);
00586 <font class="preprocessor">#else</font>
00587 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[3*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>];
00588         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 3*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>)) { 
00589           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00590         }
00591         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>; i++) { 
00592           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m62">BondHAt1</a>[i] = buffer[3*i];
00593           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m63">BondHAt2</a>[i] = buffer[3*i+1];
00594           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m64">BondHNum</a>[i] = buffer[3*i+2];
00595         }
00596         <font class="keyword">delete</font> [] buffer;
00597 <font class="preprocessor">#endif</font>
00598 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00599 
00600         <font class="comment">/* </font>
00601 <font class="comment">         * READ COVALENT BOND W/OUT HYDROGEN (3*(atnum-1)):</font>
00602 <font class="comment">         *      IB = ATOM1              -IX(I18)</font>
00603 <font class="comment">         *      JB = ATOM2              -IX(I20)</font>
00604 <font class="comment">         *      ICB = BOND ARRAY PTR    -IX(I22)</font>
00605 <font class="comment">         */</font>
00606 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00607 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>; i++)
00608           fscanf(file, <font class="stringliteral">" %d %d %d"</font>, 
00609                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m65">BondAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m66">BondAt2</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m67">BondNum</a>[i]);
00610 <font class="preprocessor">#else</font>
00611 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[3*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>];
00612         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 3*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>)) { 
00613           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00614         }
00615         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>; i++) { 
00616           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m65">BondAt1</a>[i] = buffer[3*i];
00617           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m66">BondAt2</a>[i] = buffer[3*i+1];
00618           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m67">BondNum</a>[i] = buffer[3*i+2];
00619         }
00620         <font class="keyword">delete</font> [] buffer;
00621 <font class="preprocessor">#endif</font>
00622 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00623 
00624         <font class="comment">/* </font>
00625 <font class="comment">         * READ ANGLE W/ HYDROGEN: </font>
00626 <font class="comment">         *      ITH = ATOM1                     -IX(I24)</font>
00627 <font class="comment">         *      JTH = ATOM2                     -IX(I26)</font>
00628 <font class="comment">         *      KTH = ATOM3                     -IX(I28)</font>
00629 <font class="comment">         *      ICTH = ANGLE ARRAY PTR          -IX(I30)</font>
00630 <font class="comment">         */</font>
00631 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00632 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>; i++)
00633           fscanf(file, <font class="stringliteral">" %d %d %d %d"</font>, 
00634                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m68">AngleHAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m69">AngleHAt2</a>[i], 
00635                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m70">AngleHAt3</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m71">AngleHNum</a>[i]);
00636 <font class="preprocessor">#else</font>
00637 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>];
00638         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>)) { 
00639           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00640         }
00641         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m8">Ntheth</a>; i++) { 
00642           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m68">AngleHAt1</a>[i] = buffer[4*i];
00643           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m69">AngleHAt2</a>[i] = buffer[4*i+1];
00644           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m70">AngleHAt3</a>[i] = buffer[4*i+2];
00645           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m71">AngleHNum</a>[i] = buffer[4*i+3];
00646         }
00647         <font class="keyword">delete</font> [] buffer;
00648 <font class="preprocessor">#endif</font>
00649 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00650 
00651         <font class="comment">/* </font>
00652 <font class="comment">         * READ ANGLE W/OUT HYDROGEN: </font>
00653 <font class="comment">         *      IT = ATOM1                      -IX(I32)</font>
00654 <font class="comment">         *      JT = ATOM2                      -IX(I34)</font>
00655 <font class="comment">         *      KT = ATOM3                      -IX(I36)</font>
00656 <font class="comment">         *      ICT = ANGLE ARRAY PTR           -IX(I38)</font>
00657 <font class="comment">         */</font>
00658 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00659 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>; i++)
00660           fscanf(file, <font class="stringliteral">" %d %d %d %d"</font>, 
00661                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m72">AngleAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m73">AngleAt2</a>[i], 
00662                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m74">AngleAt3</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m75">AngleNum</a>[i]);
00663 <font class="preprocessor">#else</font>
00664 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>];
00665         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 4*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>)) {
00666           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00667         }
00668         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m17">Ntheta</a>; i++) { 
00669           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m72">AngleAt1</a>[i] = buffer[4*i];
00670           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m73">AngleAt2</a>[i] = buffer[4*i+1];
00671           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m74">AngleAt3</a>[i] = buffer[4*i+2];
00672           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m75">AngleNum</a>[i] = buffer[4*i+3];
00673         }
00674         <font class="keyword">delete</font> [] buffer;
00675 <font class="preprocessor">#endif</font>
00676 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00677 
00678         <font class="comment">/* </font>
00679 <font class="comment">         * READ DIHEDRAL W/ HYDROGEN: </font>
00680 <font class="comment">         *      ITH = ATOM1                     -IX(40)</font>
00681 <font class="comment">         *      JTH = ATOM2                     -IX(42)</font>
00682 <font class="comment">         *      KTH = ATOM3                     -IX(44)</font>
00683 <font class="comment">         *      LTH = ATOM4                     -IX(46)</font>
00684 <font class="comment">         *      ICTH = DIHEDRAL ARRAY PTR       -IX(48)</font>
00685 <font class="comment">         */</font>
00686 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00687 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>; i++)
00688           fscanf(file, <font class="stringliteral">" %d %d %d %d %d"</font>, 
00689                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m76">DihHAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m77">DihHAt2</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m78">DihHAt3</a>[i], 
00690                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m79">DihHAt4</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m80">DihHNum</a>[i]);
00691 <font class="preprocessor">#else</font>
00692 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[5*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>];
00693         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 5*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>)) {
00694           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00695         }
00696         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m10">Nphih</a>; i++) { 
00697           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m76">DihHAt1</a>[i] = buffer[5*i];
00698           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m77">DihHAt2</a>[i] = buffer[5*i+1];
00699           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m78">DihHAt3</a>[i] = buffer[5*i+2];
00700           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m79">DihHAt4</a>[i] = buffer[5*i+3];
00701           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m80">DihHNum</a>[i] = buffer[5*i+4];
00702         }
00703         <font class="keyword">delete</font> [] buffer;
00704 <font class="preprocessor">#endif</font>
00705 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00706 
00707         <font class="comment">/* </font>
00708 <font class="comment">         * READ DIHEDRAL W/OUT HYDROGEN: </font>
00709 <font class="comment">         *      IT = ATOM1</font>
00710 <font class="comment">         *      JT = ATOM2</font>
00711 <font class="comment">         *      KT = ATOM3</font>
00712 <font class="comment">         *      LT = ATOM4</font>
00713 <font class="comment">         *      ICT = DIHEDRAL ARRAY PTR</font>
00714 <font class="comment">         */</font>
00715 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00716 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>; i++) {
00717           fscanf(file, <font class="stringliteral">" %d %d %d %d %d"</font>, 
00718                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m81">DihAt1</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m82">DihAt2</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m83">DihAt3</a>[i], 
00719                  &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m84">DihAt4</a>[i], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m85">DihNum</a>[i]);
00720         }
00721 <font class="preprocessor">#else</font>
00722 <font class="preprocessor"></font>        buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[5*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>];
00723         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 5*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>)) {
00724           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00725         }
00726         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m18">Nphia</a>; i++) {
00727           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m81">DihAt1</a>[i] = buffer[5*i];
00728           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m82">DihAt2</a>[i] = buffer[5*i+1];
00729           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m83">DihAt3</a>[i] = buffer[5*i+2];
00730           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m84">DihAt4</a>[i] = buffer[5*i+3];
00731           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m85">DihNum</a>[i] = buffer[5*i+4];
00732         }
00733         <font class="keyword">delete</font> [] buffer;
00734 <font class="preprocessor">#endif</font>
00735 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00736 
00737         <font class="comment">/*</font>
00738 <font class="comment">         * READ EXCLUDED ATOM LIST      -IX(I10)</font>
00739 <font class="comment">         */</font>
00740 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00741 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m14">Nnb</a>; i++)
00742                 fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m59">ExclAt</a>[i]);
00743 <font class="preprocessor">#else</font>
00744 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m59">ExclAt</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m14">Nnb</a>)) {
00745            <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00746         }
00747 <font class="preprocessor">#endif</font>
00748 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00749 
00750         <font class="comment">/*</font>
00751 <font class="comment">         * READ H-BOND R**12 TERM FOR ALL N-B TYPES     -ASOL()</font>
00752 <font class="comment">         */</font>
00753         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>; i++) 
00754           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m48">HB12</a>[i]);
00755         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00756 
00757         <font class="comment">/*</font>
00758 <font class="comment">         * READ H-BOND R**6 TERM FOR ALL N-B TYPES      -BSOL()</font>
00759 <font class="comment">         */</font>
00760         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>; i++) 
00761           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m49">HB6</a>[i]);
00762         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00763 
00764         <font class="comment">/*</font>
00765 <font class="comment">         * READ H-BOND CUTOFF (NOT USED) ??             -HBCUT()</font>
00766 <font class="comment">         */</font>
00767         H = (<a class="code" href="ReadPARM_8h.html#a1">_REAL</a> *) <a class="code" href="classReadPARM.html#a4">get</a>(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a> * <font class="keyword">sizeof</font>(<a class="code" href="ReadPARM_8h.html#a1">_REAL</a>));
00768         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m23">Nphb</a>; i++) 
00769           fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, &amp;H[i]);
00770         free((<font class="keywordtype">char</font> *)H);
00771         <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00772 
00773         <font class="comment">/*</font>
00774 <font class="comment">         * READ ATOM SYMBOLS (FOR ANALYSIS PROGS)       -IH(M06)</font>
00775 <font class="comment">         */</font>
00776         <font class="keywordflow">for</font> (i=0; i&lt;(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>/20 + (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>%20 ? 1 : 0)); i++)
00777           <a class="code" href="classReadPARM.html#a5">preadln</a>(file, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m34">AtomSym</a>[i*80]);
00778 
00779         <font class="comment">/*</font>
00780 <font class="comment">         * READ TREE SYMBOLS (FOR ANALYSIS PROGS)       -IH(M08)</font>
00781 <font class="comment">         */</font>
00782         <font class="keywordflow">for</font> (i=0; i&lt;(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>/20 + (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>%20 ? 1 : 0)); i++)
00783           <a class="code" href="classReadPARM.html#a5">preadln</a>(file, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m35">AtomTree</a>[i*80]);
00784       
00785         <font class="comment">/*</font>
00786 <font class="comment">         * READ TREE JOIN INFO (FOR ANALYSIS PROGS)     -IX(I64)</font>
00787 <font class="comment">         */</font>
00788 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00789 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++)
00790           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m60">TreeJoin</a>[i]);
00791 <font class="preprocessor">#else</font>
00792 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m60">TreeJoin</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>)) {
00793           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00794         }
00795 <font class="preprocessor">#endif</font>
00796 <font class="preprocessor"></font>        <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00797 
00798         <font class="comment">/*</font>
00799 <font class="comment">         * READ PER-ATOM RES NUMBER                     -IX(I66)</font>
00800 <font class="comment">         *      NOTE: this appears to be something entirely different</font>
00801 <font class="comment">         *      NOTE: overwriting this with correct PER-ATOM RES NUMBERs</font>
00802 <font class="comment">         */</font>
00803 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00804 <font class="preprocessor"></font>        <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++)
00805           fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m61">AtomRes</a>[i]);
00806 <font class="preprocessor">#else</font>
00807 <font class="preprocessor"></font>        <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m61">AtomRes</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>)) {
00808           <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00809         }
00810 <font class="preprocessor">#endif</font>
00811 <font class="preprocessor"></font>        res = 0;
00812         <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>; i++) {
00813           <font class="keywordflow">if</font> (i+1 == <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[res+1]) <font class="comment">/* atom is 1st of next res */</font>
00814             res++;
00815           <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m61">AtomRes</a>[i] = res;
00816         }
00817       
00818         <font class="comment">/*</font>
00819 <font class="comment">         * BOUNDARY CONDITION STUFF</font>
00820 <font class="comment">         */</font>
00821         <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m1">IfBox</a>) {
00822                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a> = 1;
00823                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m86">Boundary</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a>);
00824                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m86">Boundary</a>[0] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>;
00825         } <font class="keywordflow">else</font> {
00826                 <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00827 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00828 <font class="preprocessor"></font>                fscanf(file, <font class="stringliteral">" %d %d %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m28">Iptres</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a>, 
00829                                                                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m29">Nspsol</a>);
00830 <font class="preprocessor">#else</font>
00831 <font class="preprocessor"></font>                buffer = <font class="keyword">new</font> <font class="keywordtype">int</font>[3];
00832                 <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, buffer, 3)) { 
00833                   <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00834                 }
00835                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m28">Iptres</a> = buffer[0];
00836                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a> = buffer[1];
00837                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m29">Nspsol</a> = buffer[2];
00838                 <font class="keyword">delete</font> [] buffer;
00839 <font class="preprocessor">#endif</font>
00840 <font class="preprocessor"></font>                <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00841                 <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m86">Boundary</a> = (<font class="keywordtype">int</font> *) <a class="code" href="classReadPARM.html#a4">get</a>(<font class="keyword">sizeof</font>(<font class="keywordtype">int</font>)*<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a>);
00842 <font class="preprocessor">#if !defined(USENEWCODE)</font>
00843 <font class="preprocessor"></font>                <font class="keywordflow">for</font> (i=0; i&lt;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a>; i++)
00844                         fscanf(file, <font class="stringliteral">" %d"</font>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m86">Boundary</a>[i]);
00845 <font class="preprocessor">#else</font>
00846 <font class="preprocessor"></font>                <font class="keywordflow">if</font> (!<a class="code" href="classReadPARM.html#a13">read_fortran_12I6</a>(file, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m86">Boundary</a>, <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m27">Nspm</a>)) {
00847                   <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a4">MOLFILE_ERROR</a>;
00848                 }
00849 <font class="preprocessor">#endif</font>
00850 <font class="preprocessor"></font>                <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00851                 fscanf(file, <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a> <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a> <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>, 
00852                                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m50">Box</a>[0], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m50">Box</a>[1], &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m50">Box</a>[2]);
00853                 <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(file);
00854                 <font class="keywordflow">if</font> (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m28">Iptres</a>)
00855                         <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m30">Ipatm</a> = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m28">Iptres</a>] - 1; 
00856                 <font class="comment">/* IF(IPTRES.GT.0) IPTATM = IX(I02+IPTRES-1+1)-1 */</font>
00857         }
00858 
00859         <font class="comment">/*</font>
00860 <font class="comment">         * ----- LOAD THE CAP INFORMATION IF NEEDED -----</font>
00861 <font class="comment">         */</font>
00862         <font class="keywordflow">if</font> (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m3">IfCap</a>) {
00863                 <font class="comment">/* if (prm-&gt;IfBox) </font>
00864 <font class="comment">                        skipeoln(file); */</font>
00865                 fscanf(file, <font class="stringliteral">" %d "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a> <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a> <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a> <font class="stringliteral">" "</font> <a class="code" href="ReadPARM_8h.html#a2">DBLFMT</a>,
00866                                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m31">Natcap</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m51">Cutcap</a>, 
00867                                 &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m52">Xcap</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m53">Ycap</a>, &amp;<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m54">Zcap</a>);
00868         }
00869 
00870   <font class="keywordflow">return</font> <a class="code" href="molfile__plugin_8h.html#a2">MOLFILE_SUCCESS</a>;
00871 }
00872 
00873 
<a name="l00874"></a><a class="code" href="classReadPARM.html#a7">00874</a> <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a7">ReadPARM::get_parm_atom</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">char</font> *<a class="code" href="xsfplugin_8C.html#a2">name</a>, <font class="keywordtype">char</font> *atype, <font class="keywordtype">char</font> *resname,
00875 <font class="keywordtype">char</font> *segname, <font class="keywordtype">int</font> *resid, <font class="keywordtype">float</font> *q, <font class="keywordtype">float</font> *m) {
00876   <font class="keywordtype">int</font> nres = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m15">Nres</a>;
00877 
00878   <font class="keywordtype">int</font> j,k;
00879   <font class="keywordtype">int</font> flag = 0;
00880   <font class="keywordtype">char</font> *blank = (<font class="keywordtype">char</font> *) <font class="stringliteral">" "</font>;
00881 
00882   *q = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m36">Charges</a>[i];
00883   *m = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m37">Masses</a>[i];
00884 
00885   <font class="keywordflow">for</font> (k = 0; k &lt; 4; k++) {
00886     <font class="keywordflow">if</font> (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m32">AtomNames</a>[i*4+k] == *blank)
00887        <a class="code" href="xsfplugin_8C.html#a2">name</a>[k] = <font class="charliteral">'\0'</font>;
00888     <font class="keywordflow">else</font>
00889        <a class="code" href="xsfplugin_8C.html#a2">name</a>[k] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m32">AtomNames</a>[i*4+k];
00890   }
00891   <a class="code" href="xsfplugin_8C.html#a2">name</a>[k] = <font class="charliteral">'\0'</font>;
00892 
00893   <font class="keywordflow">for</font> (k = 0; k &lt; 4; k++) {
00894     <font class="keywordflow">if</font> ((<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m34">AtomSym</a>[i*4+k]) == *blank)
00895        atype[k] = <font class="charliteral">'\0'</font>;
00896     <font class="keywordflow">else</font>
00897        atype[k] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m34">AtomSym</a>[i*4+k];
00898   }
00899   atype[k] = <font class="charliteral">'\0'</font>;
00900 
00901   <font class="keywordflow">for</font> (j = 0; j &lt; nres-1; j++)
00902     <font class="keywordflow">if</font> (((i+1) &gt;= <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[j]) &amp;&amp; ((i+1) &lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m58">Ipres</a>[j+1])) {
00903       *resid = j;
00904       resname[0] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4];
00905       resname[1] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4+1];
00906       resname[2] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4+2];
00907       resname[3] = <font class="charliteral">'\0'</font>;
00908       flag = 1;
00909     }
00910   <font class="keywordflow">if</font> (flag == 0) {
00911      *resid = j;
00912      resname[0] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4];
00913      resname[1] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4+1];
00914      resname[2] = <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m33">ResNames</a>[j*4+2];
00915      resname[3] = <font class="charliteral">'\0'</font>;
00916      flag = 1;
00917   }
00918 
00919   segname[0] = <font class="charliteral">'\0'</font>; 
00920 
00921 }
00922 
<a name="l00923"></a><a class="code" href="classReadPARM.html#a8">00923</a> <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a8">ReadPARM::get_parm_bond</a> (<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> fromAtom[], <font class="keywordtype">int</font> toAtom[]) {
00924 
00925   <font class="keywordflow">if</font> (i &lt; <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>) {
00926      fromAtom[i] = (int) ((<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m65">BondAt1</a>[i])/3 + 1);
00927      toAtom[i] =   (int) ((<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m66">BondAt2</a>[i])/3 + 1);
00928   }
00929   <font class="keywordflow">else</font> <a class="code" href="classReadPARM.html#a9">get_hydrogen_bond</a> (i, fromAtom, toAtom);
00930 }
00931 
<a name="l00932"></a><a class="code" href="classReadPARM.html#a9">00932</a> <font class="keywordtype">void</font> <a class="code" href="classReadPARM.html#a9">ReadPARM::get_hydrogen_bond</a>(<font class="keywordtype">int</font> i, <font class="keywordtype">int</font> fromAtom[], <font class="keywordtype">int</font> toAtom[]) {
00933   fromAtom[i] = (int) ((<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m62">BondHAt1</a>[i-<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>])/3 + 1);
00934   toAtom[i] = (int) ((<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m63">BondHAt2</a>[i-<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a>])/3 + 1);
00935 }
00936 
00937 
<a name="l00938"></a><a class="code" href="classReadPARM.html#a10">00938</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a10">ReadPARM::get_parm_natoms</a>() {<font class="keywordflow">return</font> <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m4">Natom</a>;}
00939 
<a name="l00940"></a><a class="code" href="classReadPARM.html#a11">00940</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a11">ReadPARM::get_parm_nbonds</a>() {<font class="keywordflow">return</font> (<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m16">Nbona</a> + <a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m6">Nbonh</a>);}
00941 
<a name="l00942"></a><a class="code" href="classReadPARM.html#a12">00942</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a12">ReadPARM::get_parm_boxInfo</a>() {<font class="keywordflow">return</font>(<a class="code" href="classReadPARM.html#m1">prm</a>-&gt;<a class="code" href="structparm.html#m1">IfBox</a>);}
00943 
00944 
00945 <font class="comment">// Read FORTRAN 12I6 format data (no space between adjacent data is assumed)</font>
00946 <font class="comment">// One needs to read the whole data block into the buffer here</font>
00947 <font class="comment">// fp - file pointer.</font>
00948 <font class="comment">// data - buffer to hold the whole block. Should be allocated before the call</font>
00949 <font class="comment">// count - number of ints in the block.</font>
<a name="l00950"></a><a class="code" href="classReadPARM.html#a13">00950</a> <font class="keywordtype">int</font> <a class="code" href="classReadPARM.html#a13">ReadPARM::read_fortran_12I6</a>(FILE *fp, <font class="keywordtype">int</font> *data, <font class="keywordtype">int</font> count) {
00951   <font class="keywordtype">int</font> i, j;
00952   <font class="keywordtype">char</font> buf[7];
00953 
00954   <font class="keywordflow">for</font> (i=0; i&lt;count; ++i) { 
00955     <font class="keywordflow">for</font> (j=0; j&lt;6; ++j) { 
00956       buf[j]=getc(fp);
00957       <font class="keywordflow">if</font> (buf[j]==<font class="charliteral">'\n'</font> || buf[j]==<font class="charliteral">'\0'</font> || buf[j]==EOF)
00958         <font class="keywordflow">return</font> 0;
00959     }
00960     buf[6] = <font class="charliteral">'\0'</font>;
00961 
00962     <font class="keywordflow">if</font> (sscanf(buf,<font class="stringliteral">"%d"</font>,data+i) != 1)
00963       <font class="keywordflow">return</font> 0;
00964 
00965     <font class="keywordflow">if</font> (i%12==11 &amp;&amp; i&lt;count-1)
00966       <a class="code" href="ReadPARM_8h.html#a4">readtoeoln</a>(fp);
00967   }
00968 
00969   <font class="keywordflow">return</font> 1;
00970 }
00971 
00972 
00973 <font class="preprocessor">#endif</font>
00974 <font class="preprocessor"></font>
</pre></div><hr><address><small>Generated on Wed Mar 22 13:15:31 2006 for VMD Plugins (current) by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.14 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2002</small></address>
</body>
</html>
